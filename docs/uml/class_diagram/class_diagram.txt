@startuml
!theme sandstone
!define RECTANGLE class

title **Class Diagram - Hackathon Platform**\n**Modello del Dominio**

' region Classi

class Utente {
    - utente_id: int
    - username: string
    - email: string
    - password_hash: string
    - nome: string
    - cognome: string
    - data_registrazione: Date
    - attivo: boolean
    --
    + registrati(): boolean
    + autenticati(password: string): boolean
    + modificaProfilo(): void
    + isOrganizzatore(): boolean
    + isGiudice(): boolean
    + isPartecipante(): boolean
}

class Hackathon {
    - hackathon_id: int
    - titolo: string
    - descrizione: string
    - sede: string
    - data_inizio: Date
    - data_fine: Date
    - data_chiusura_registrazioni: Date
    - max_iscritti: int
    - max_dimensione_team: int
    - status: HackathonStatus
    - data_creazione: Date
    --
    + creaHackathon(): boolean
    + apriRegistrazioni(): void
    + chiudiRegistrazioni(): void
    + iniziaHackathon(): void
    + terminaHackathon(): void
    + verificaVincoli(): boolean
    + getNumeroIscritti(): int
    + getNumeroTeam(): int
}

class Team {
    - team_id: int
    - nome: string
    - data_creazione: Date
    - definitivo: boolean
    --
    + creaTeam(nome: string): boolean
    + aggiungiMembro(utente: Utente): boolean
    + rimuoviMembro(utente: Utente): boolean
    + rendiDefinitivo(): void
    + getNumeroMembri(): int
    + verificaDimensioneMassima(): boolean
    + getNomiMembri(): List<string>
}

class Problema {
    - problema_id: int
    - titolo: string
    - descrizione: string
    - data_pubblicazione: Date
    --
    + pubblicaProblema(): boolean
    + modificaDescrizione(nuova: string): void
    + getDettagli(): string
}

class Progresso {
    - progresso_id: int
    - titolo: string
    - descrizione: string
    - documento_path: string
    - documento_nome: string
    - data_caricamento: Date
    --
    + caricaProgresso(): boolean
    + aggiornaDocumento(path: string): void
    + getDettagliCaricamento(): string
}

class Voto {
    - voto_id: int
    - valore: int
    - criteri_valutazione: string
    - data_voto: Date
    --
    + assegnaVoto(valore: int): boolean
    + modificaVoto(nuovoValore: int): boolean
    + validaVoto(): boolean
    + getDettagliVoto(): string
}

class Registrazione {
    - registrazione_id: int
    - data_registrazione: Date
    --
    + registraUtente(): boolean
    + annullaRegistrazione(): boolean
    + assegnaTeam(team: Team): void
}

class MembroTeam {
    - membro_team_id: int
    - data_ingresso: Date
    - ruolo_team: RuoloTeam
    --
    + joinTeam(): boolean
    + leaveTeam(): boolean
    + promoteToLeader(): void
}

class GiudiceHackathon {
    - giudice_hackathon_id: int
    - data_invito: Date
    - stato_invito: StatoInvito
    --
    + invitaGiudice(): boolean
    + accettaInvito(): boolean
    + rifiutaInvito(): boolean
}

class Commento {
    - commento_id: int
    - testo: string
    - data_commento: Date
    --
    + scriviCommento(testo: string): boolean
    + modificaCommento(nuovoTesto: string): boolean
}

class InvitoTeam {
    - invito_id: int
    - messaggio_motivazionale: string
    - stato_invito: StatoInvito
    - data_invito: Date
    - data_risposta: Date
    --
    + inviaInvito(messaggio: string): boolean
    + accettaInvito(): boolean
    + rifiutaInvito(): boolean
}

' endregion

' region Enums

enum HackathonStatus {
    REGISTRAZIONI_APERTE
    REGISTRAZIONI_CHIUSE
    IN_CORSO
    TERMINATO
}

enum RuoloTeam {
    LEADER
    MEMBRO
}

enum StatoInvito {
    PENDING
    ACCEPTED
    DECLINED
}

' endregion

' region Relazioni

' Utente - Hackathon (Organizzazione)
Utente ||--o{ Hackathon : "organizza >"
Utente }o--|| Hackathon : "+organizzatore\n1"

' Hackathon - Team
Hackathon ||--o{ Team : "contiene >"
Team }o--|| Hackathon : "+hackathon\n1"

' Hackathon - Problema
Hackathon ||--o{ Problema : "definisce >"
Problema }o--|| Hackathon : "+hackathon\n1"

' Utente - Problema (Pubblicazione)
Utente ||--o{ Problema : "pubblica >"
Problema }o--|| Utente : "+pubblicato_da\n1"

' Utente - Hackathon (Partecipazione tramite Registrazione)
Utente ||--o{ Registrazione : "si_registra >"
Registrazione }o--|| Utente : "+utente\n1"
Hackathon ||--o{ Registrazione : "riceve_registrazioni >"
Registrazione }o--|| Hackathon : "+hackathon\n1"

' Team - Registrazione
Team ||--o{ Registrazione : "include >"
Registrazione }o--o| Team : "+team\n0..1"

' Utente - Team (Membership tramite MembroTeam)
Team ||--o{ MembroTeam : "composto_da >"
MembroTeam }o--|| Team : "+team\n1"
Utente ||--o{ MembroTeam : "partecipa_in >"
MembroTeam }o--|| Utente : "+utente\n1"

' Team - Progresso
Team ||--o{ Progresso : "carica >"
Progresso }o--|| Team : "+team\n1"

' Utente - Progresso (Autore)
Utente ||--o{ Progresso : "carica_da >"
Progresso }o--|| Utente : "+caricato_da\n1"

' Progresso - Commento
Progresso ||--o{ Commento : "riceve >"
Commento }o--|| Progresso : "+progresso\n1"

' Utente - Commento (Giudice)
Utente ||--o{ Commento : "scrive >"
Commento }o--|| Utente : "+giudice\n1"

' Utente - Hackathon (Giudice tramite GiudiceHackathon)
Utente ||--o{ GiudiceHackathon : "giudica >"
GiudiceHackathon }o--|| Utente : "+giudice\n1"
Hackathon ||--o{ GiudiceHackathon : "ha_giudici >"
GiudiceHackathon }o--|| Hackathon : "+hackathon\n1"

' Utente - GiudiceHackathon (Invitante)
Utente ||--o{ GiudiceHackathon : "invita >"
GiudiceHackathon }o--|| Utente : "+invitato_da\n1"

' Voti (Utente-Team-Hackathon)
Utente ||--o{ Voto : "assegna >"
Voto }o--|| Utente : "+giudice\n1"
Team ||--o{ Voto : "riceve >"
Voto }o--|| Team : "+team\n1"
Hackathon ||--o{ Voto : "contiene_voti >"
Voto }o--|| Hackathon : "+hackathon\n1"

' Inviti Team (Bonus - Gruppi da 3)
Team ||--o{ InvitoTeam : "invia_inviti >"
InvitoTeam }o--|| Team : "+team\n1"
Utente ||--o{ InvitoTeam : "invita >"
InvitoTeam }o--|| Utente : "+invitante\n1"
Utente ||--o{ InvitoTeam : "riceve_inviti >"
InvitoTeam }o--|| Utente : "+invitato\n1"

' Associazioni con Enum
Hackathon }o--|| HackathonStatus : "+status\n1"
MembroTeam }o--|| RuoloTeam : "+ruolo\n1"
GiudiceHackathon }o--|| StatoInvito : "+stato\n1"
InvitoTeam }o--|| StatoInvito : "+stato\n1"

' endregion

' region Note e Vincoli

note top of Utente : **Utente unico (centralizzato)**\nPuò essere Organizzatore,\nPartecipante e/o Giudice

note right of Team : **Vincoli:**\n• Nome univoco per hackathon\n• Dimensione <= max_dimensione_team\n• Utente in un solo team per hackathon

note left of Hackathon : **Vincoli Temporali:**\n• data_inizio < data_fine\n• data_chiusura < data_inizio\n• Registrazioni chiudono 2 giorni prima

note bottom of Voto : **Vincoli:**\n• Valore: 0 <= valore <= 10\n• Un giudice vota un team\n  una sola volta per hackathon

' endregion
@enduml